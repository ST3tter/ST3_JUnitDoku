%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Titel:   Schlusswort
% Autor:   
% Datum:   
% Version: 0.0.0
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%:::Change-Log:::
% Versionierung erfolgt auf folgende Gegebenheiten: -1. Release Versionen
%                                                   -2. Neue Kapitel
%                                                   -3. Fehlerkorrekturen
%
% 0.0.0       Erstellung der Datei
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Erstellen eines JUnit-Tests}\label{ch:testerstellen}
	Seit der Version 3.2 ist \textsf{JUnit} ein fester Bestandteil der \textsf{Eclipse IDE}. Somit ist das Testen von Software in \textsf{Eclipse} einfacher denn je. Eine Klasse kann bei der Erstellung der Tests selektiert werden und der Benutzer kann ohne jeglichen Code schreiben zu müssen die Grobstruktur des Test generieren. In der Folgenden Anleitung werden die einzelnen Schritte der Reihe nach erl"autert.\par
	%
	Die folgende Anleitung wird anhand eines simplen Rechners als Beispiel veranschaulicht. Mit Hilfe dieses Modells werden die grundlegenden Schritte für das erfolgreiche Erstellen eines Test beschrieben.
	%
	\section{Calculator Modell}\label{s:calculatormodell}
		Wie Bereits erwähnt, wird als einfaches Beispiel ein Rechner umgesetzt. Um die Funktionsweise eines Unit-Test zu verdeutlichen werden zwei Methoden implementiert:
		%
		\begin{description}
			\item[add()] Die Methode \textsf{add()} addiert zwei übergebene Integer und gib das Resultat zur"uck.
			\item[multyply()] Diese Methode multipliziert zwei Variablen und liefert das Ergebnis zur"uck. 
		\end{description}
		%
		Die Klasse mit diesen beiden simplen Methoden wird, wie in Listing \ref{list:calculatorclass} abgebildet, in einem neuen Java-Projekt implementiert.

\begin{lstlisting}[style=JAVA,caption={Calculator Klasse},label={list:calculatorclass}]
package ApplicationCode;

public class Calculator {
	
	public int add(int num1, int num2){
		return num1 + num2;
	}
	
	public int multiply(int num1, int num2){
		return num1 * num2;
	}

}
\end{lstlisting}
		%
	\section{Schritt f"ur Schritt Anleitung}\label{s:anleitung}
		Auf den Folgenden Seiten wird Schritt f"ur Schritt auf die einzelnen Arbeitsschritte eines erfolgreichen Unit-Test mit \textsf{JUnit} eingegangen. Dabei wird das das in \ref{s:calculatormodell} auf Seite \pageref{s:calculatormodell} beschriebene Modell getestet.
		%
		\subsection*{Ordnerstruktur}\label{s:ordnerstruktur}
			Um ein Unit-Test zu erstellen empfiehlt es sich innerhalb eines Projektes eine klare Struktur für die Tests aufzubauen. Eine gute M"oglichkeit die Test vom "ubrigen Code Abzutrennen ist ein zusätzlicher Source-Folder. Diese kann via \textcolor{bfhorange}{\textsf{File $\rightarrow$ New $\rightarrow$ Source Folder}} erstellt werden. Der neue Ordner sollte einen etwas aussagekräftigen Namen wie z.B. Test, UnitTest oder etwas in diese Richtung haben, damit eine andere Person einfach erkennen kann, für was dieser Ordner erstellt wurde.
			%
		\subsection*{Erstellen einer Testklasse}\label{s:testklasseerstellen}
		Nach dem Erstellen des neuen Ordners kann eine neue Testklasse erstellt werden. Dazu wird mit \textcolor{bfhorange}{\textsf{File $\rightarrow$ New $\rightarrow$ Other...}} das Kontextmen"u (Abbildung \ref{abb:auswahljunit}) für neue Klassen aufgerufen werden.\par
		%
		\image{content/testerstellen/image/AuswahlJUnit.png}{scale=0.4}{htbp}[Auswahl JUnit Test Case][Auswahl JUnit Test Case][abb:auswahljunit]
		%
		Im Suchfeld kann Nach \textsf{JUnit} gesucht werden. Durch selektieren von JUnit Test Case und Klicken auf Next, wird das nächste Fenster geöffnet. Im neuen Menü, abgebildet in der Grafik \ref{abb:testcaseerstellen}, müssen folgende Einstellungen vorgenommen werden:
		%
		\image{content/testerstellen/image/TestCaseErstellen.png}{scale=0.4}{htbp}[Test Case Einstellungen][Einstellungen für den JUnit Test Case][abb:testcaseerstellen] 
		%
		\begin{enumerate}
		\item New JUnit 4 test.
		\item Auswahl des erstellten Test Source-Folders.
		\item Erstellen oder auswählen eines Packages innerhalb des Ordners
		\item Name f"ur den Test eingeben (hier CalculatorTest)
		\item Wenn gewünscht können Hilfsmethoden ausgewählt werden.
		\item Auswahl der Klasse, die getestet werden soll.
		\item Weiter mit dem Next-Button
		\end{enumerate}
		%
		\newpage
		Im n"achsten Fenster (Abbildung \ref{abb:auswahlmethoden}) kann ausgewählt werden, welche Methoden getestet werden sollen. Für den Rechner werden die beiden Funktionen add() und multyply() getestet. Durch Klicken auf Finish wird die Testklasse erstellt.\par
		%
		\image{content/testerstellen/image/AuswahlMethoden.png}{scale=0.35}{htbp}[Auswahl der Methoden][Auswahl der zu testenden Methoden][abb:auswahlmethoden] 
		%
		Beim Erstellen der Ersten Testklasse erscheint, wie in Abbildung \ref{abb:warningjunit4} dahrgestellt, eine Meldung, da die JUnit Library noch nicht im Pfad des Projektes eingebunden ist. Die Standardeinstellung in diesem Fenster (\textsf{Perform the following action:} und der Auswahl  \textsf{Add JUnit library to the build path}) ist für die meisten Anwendung die Richtige, so auch in diesem Beispiel. Durch klicken auf OK wird die Library in den Pfad des Projektes eingebunden und JUnit kann genutzt werden. 
		%
		\image{content/testerstellen/image/WarningJunit4.png}{scale=0.35}{htbp}[Warnung JUnit nicht im Pfad][Warnung JUnit nicht im Pfad][abb:warningjunit4] 
		%
		\newpage
		Anschliessend wird die Testklasse automatisch generiert. Dabei wird für den Test des Rechners folgender Code erzeugt:\\
		%
\begin{lstlisting}[style=JAVA,caption={Testklasse},label={list:testklasse}]
package ApplicationCodeTest;

import static org.junit.Assert.*;
import org.junit.Test;

import ApplicationCode.Calculator;

public class CalculatorTest {

	@Test
	public void testAdd() {
		fail("Not yet implemented");
	}

	@Test
	public void testMultiply() {
		fail("Not yet implemented");
	}
}
\end{lstlisting}
		%
		Wie in Listing \ref{list:testklasse} zu sehen ist, werden für beide Methoden des Rechners jeweils eine Testmethode mit der \textsf{@Test} Annotation\footnote{Erklährung zu den Annotationen im Kapitel \ref{ss:annotationen} auf Seite \pageref{ss:annotationen}} erstellt. Die neu Erstellten Testmethoden werden grundsätzlich nach dem Schema \textsf{test} + \textsf{Methodenname der zu testenden Methode()} benannt. Standardmässig werden die alle Testmethoden mit dem Aufruf \textsf{fail("Not yet implemented")} erzeugt.
		%
		\subsection*{Den Test laufen lassen}\label{ss:testlaufenlassen}
			Nach dem Erstellen der Testklasse und deren Methoden kann der Test einmal durchlaufen werden. Gestartet wird ein Test unter \textcolor{bfhorange}{\textsf{Run $\rightarrow$ Run As $\rightarrow$ JUnit Test}}.\par
			%
			Nach dem Durchlaufen des Tests erscheint auf der linken Seite in der \textsf{Eclipse IDE} ein neuer \textsf{JUnit} Tab mit den Testresultaten. Die Abbildung \ref{abb:erstertestlauf} auf der folgenden Seite zeigt diesen Tab nach dem der generierte Test ausgef"uhrt wurde. Im oberen Bereich ist zu sehen, dass zwei von zwei Test durchgeführt wurden (Runs: 2/2). Beide Test sind jedoch gescheitert (Failures: 2), da bei der Standardimplementation der Testmethoden der bereits erwähnte \textsf{fail("Not yet implemented")} Aufruf generiert wurde.\par
			%
			\image{content/testerstellen/image/Fehler.png}{scale=0.5}{htbp}[Erster Testlauf][Erster JUnit Testlauf][abb:erstertestlauf] 
			%
		\newpage
		\subsection*{Tests schreiben}\label{ss:testschreiben}
			Damit die Test nicht nur eine Fehlermeldung ausgeben, muss Testcode für die beiden Methoden geschrieben werden. Im Listing \ref{list:testklasseinhalt} ist ein Beispiel für die Implementierung der Testmethoden abgebildet.
			%
\begin{lstlisting}[style=JAVA,caption={Testklasse},label={list:testklasseinhalt}]
public class CalculatorTest {

	@Test
	public void testAdd() {
		Calculator myCalculator = new Calculator();
		/* Prüft, die Addition von 2 + 3 gleich 5 ist */
		assertTrue("Addition test", myCalculator.add(2, 3) == 5);
	}

	@Test
	public void testMultiply() {
		Calculator myCalculator = new Calculator();
		/* Prüft, die Multiplikation von 3 * 5 gleich 15 ist */
		assertTrue("Multiply test", myCalculator.multiply(3, 5) == 15);
	}

}
\end{lstlisting}
		%
		%
	\newpage
	\section{Zusammenfassung}\label{s:zusammenfassung}
		Die einzelnen Schritte werden hier noch einmal kurz zusammengefasst:
		%
		\begin{enumerate}
			\item Source-Folder für Tests erstellen unter \textcolor{bfhorange}{\textsf{File $\rightarrow$ New $\rightarrow$ Source Folder}}.
			%
			\item Menu für eine neue Testklasse öffnen mit \textcolor{bfhorange}{\textsf{File $\rightarrow$ New $\rightarrow$ Other... $\rightarrow$ JUnit Test Case}}.
			%
			\item Einstellungen (siehe Abbildung \ref{abb:testcaseerstellen} auf Seite \pageref{abb:testcaseerstellen}) für die Testklasse vornehmen und auf Next klicken.
			%
			\item Auswahl der zu testenden Methoden, beenden mit Klick auf Finish.
			%
			\item Die JUnit Library in das Projekt einbinden, erscheint ein Fenster mit einer Warnung.
			%
			\item Funktionalität der Testmethoden implementieren
			%
			\item Test Starten mit \textcolor{bfhorange}{\textsf{Run $\rightarrow$ Run As $\rightarrow$ JUnit Test}}
		\end{enumerate}